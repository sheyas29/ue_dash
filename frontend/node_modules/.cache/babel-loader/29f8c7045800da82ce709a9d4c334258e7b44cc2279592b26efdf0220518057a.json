{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AttendanceForm=_ref=>{let{contractId}=_ref;const[employees,setEmployees]=useState([]);const[attendanceData,setAttendanceData]=useState([]);const[selectedMonthYear,setSelectedMonthYear]=useState('');const[workingDays,setWorkingDays]=useState('');useEffect(()=>{const fetchEmployees=async()=>{try{const response=await axios.get(\"http://localhost:5000/api/contracts/\".concat(contractId,\"/employees\"));setEmployees(response.data);}catch(error){console.error('Error fetching employees:',error);}};fetchEmployees();},[contractId]);const handleAttendanceChange=(e,employeeId)=>{const{name,value}=e.target;setAttendanceData(prevData=>{const existingRecord=prevData.find(record=>record.employeeId===employeeId);if(existingRecord){return prevData.map(record=>record.employeeId===employeeId?{...record,[name]:value}:record);}else{const employee=employees.find(emp=>emp._id===employeeId);return[...prevData,{employeeId,[name]:value,dailyWage:employee.dailyWage}];}});};const handleSave=async()=>{const attendancePayload=attendanceData.map(record=>({...record,contractId,month:selectedMonthYear.split('-')[1],year:selectedMonthYear.split('-')[0],workingDays}));console.log('Saving attendance data:',{records:attendancePayload});try{const response=await axios.post(\"http://localhost:5000/api/contracts/\".concat(contractId,\"/attendance\"),{records:attendancePayload});console.log('Attendance data saved:',response.data);}catch(error){console.error('Error saving attendance data:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-form p-6 bg-white rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold text-gray-800 mb-4 text-center\",children:\"Add Attendance\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 font-medium mb-1\",children:\"Month and Year:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"month\",value:selectedMonthYear,onChange:e=>setSelectedMonthYear(e.target.value),className:\"block w-full mt-1 p-2 border border-gray-300 bg-white rounded-md shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 font-medium mb-1\",children:\"Working Days:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Working Days\",value:workingDays,onChange:e=>setWorkingDays(e.target.value),className:\"block w-full mt-1 p-2 border border-gray-300 bg-white rounded-md shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50\"})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white border border-gray-300 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{backgroundColor:'#e63946'},children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 border-b border-gray-300 text-left text-sm font-medium text-white\",children:\"Employee Name\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 border-b border-gray-300 text-left text-sm font-medium text-white\",children:\"Daily Wage\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 border-b border-gray-300 text-left text-sm font-medium text-white\",children:\"Attendance\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:employees.map(employee=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-gray-300\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2 text-sm text-gray-800\",children:employee.name}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2 text-sm text-gray-800\",children:employee.dailyWage}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2\",children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"attendance\",onChange:e=>handleAttendanceChange(e,employee._id),className:\"block w-full p-2 border border-gray-300 bg-white rounded-md shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50\"})})]},employee._id))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,className:\"mt-4 bg-jet text-white font-semibold py-2 px-4 rounded-md hover:bg-neutral-700 focus:outline-none focus:ring-2 focus:ring-blue-300\",children:\"Save\"})]});};export default AttendanceForm;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","AttendanceForm","_ref","contractId","employees","setEmployees","attendanceData","setAttendanceData","selectedMonthYear","setSelectedMonthYear","workingDays","setWorkingDays","fetchEmployees","response","get","concat","data","error","console","handleAttendanceChange","e","employeeId","name","value","target","prevData","existingRecord","find","record","map","employee","emp","_id","dailyWage","handleSave","attendancePayload","month","split","year","log","records","post","className","children","type","onChange","placeholder","style","backgroundColor","onClick"],"sources":["C:/Users/kshre/OneDrive/Desktop/my-manpower-dashboard/frontend/src/components/AttendanceForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst AttendanceForm = ({ contractId }) => {\r\n  const [employees, setEmployees] = useState([]);\r\n  const [attendanceData, setAttendanceData] = useState([]);\r\n  const [selectedMonthYear, setSelectedMonthYear] = useState('');\r\n  const [workingDays, setWorkingDays] = useState('');\r\n\r\n  useEffect(() => {\r\n    const fetchEmployees = async () => {\r\n      try {\r\n        const response = await axios.get(`http://localhost:5000/api/contracts/${contractId}/employees`);\r\n        setEmployees(response.data);\r\n      } catch (error) {\r\n        console.error('Error fetching employees:', error);\r\n      }\r\n    };\r\n\r\n    fetchEmployees();\r\n  }, [contractId]);\r\n\r\n  const handleAttendanceChange = (e, employeeId) => {\r\n    const { name, value } = e.target;\r\n    setAttendanceData((prevData) => {\r\n      const existingRecord = prevData.find(record => record.employeeId === employeeId);\r\n      if (existingRecord) {\r\n        return prevData.map(record =>\r\n          record.employeeId === employeeId ? { ...record, [name]: value } : record\r\n        );\r\n      } else {\r\n        const employee = employees.find(emp => emp._id === employeeId);\r\n        return [...prevData, { employeeId, [name]: value, dailyWage: employee.dailyWage }];\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    const attendancePayload = attendanceData.map(record => ({\r\n      ...record,\r\n      contractId,\r\n      month: selectedMonthYear.split('-')[1],\r\n      year: selectedMonthYear.split('-')[0],\r\n      workingDays\r\n    }));\r\n    console.log('Saving attendance data:', { records: attendancePayload });\r\n\r\n    try {\r\n      const response = await axios.post(`http://localhost:5000/api/contracts/${contractId}/attendance`, { records: attendancePayload });\r\n      console.log('Attendance data saved:', response.data);\r\n    } catch (error) {\r\n      console.error('Error saving attendance data:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"attendance-form p-6 bg-white rounded-lg shadow-md\">\r\n      <h3 className=\"text-2xl font-bold text-gray-800 mb-4 text-center\">Add Attendance</h3>\r\n      <div className=\"mb-4\">\r\n        <label className=\"block text-gray-700 font-medium mb-1\">Month and Year:</label>\r\n        <input\r\n          type=\"month\"\r\n          value={selectedMonthYear}\r\n          onChange={(e) => setSelectedMonthYear(e.target.value)}\r\n          className=\"block w-full mt-1 p-2 border border-gray-300 bg-white rounded-md shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50\"\r\n        />\r\n      </div>\r\n      <div className=\"mb-4\">\r\n        <label className=\"block text-gray-700 font-medium mb-1\">Working Days:</label>\r\n        <input\r\n          type=\"number\"\r\n          placeholder=\"Working Days\"\r\n          value={workingDays}\r\n          onChange={(e) => setWorkingDays(e.target.value)}\r\n          className=\"block w-full mt-1 p-2 border border-gray-300 bg-white rounded-md shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50\"\r\n        />\r\n      </div>\r\n      <table className=\"min-w-full bg-white border border-gray-300 rounded-lg shadow-sm\">\r\n        <thead>\r\n          <tr style={{ backgroundColor: '#e63946' }}>\r\n            <th className=\"px-4 py-2 border-b border-gray-300 text-left text-sm font-medium text-white\">Employee Name</th>\r\n            <th className=\"px-4 py-2 border-b border-gray-300 text-left text-sm font-medium text-white\">Daily Wage</th>\r\n            <th className=\"px-4 py-2 border-b border-gray-300 text-left text-sm font-medium text-white\">Attendance</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {employees.map((employee) => (\r\n            <tr key={employee._id} className=\"border-b border-gray-300\">\r\n              <td className=\"px-4 py-2 text-sm text-gray-800\">{employee.name}</td>\r\n              <td className=\"px-4 py-2 text-sm text-gray-800\">{employee.dailyWage}</td>\r\n              <td className=\"px-4 py-2\">\r\n                <input\r\n                  type=\"number\"\r\n                  name=\"attendance\"\r\n                  onChange={(e) => handleAttendanceChange(e, employee._id)}\r\n                  className=\"block w-full p-2 border border-gray-300 bg-white rounded-md shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50\"\r\n                />\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n      <button\r\n        onClick={handleSave}\r\n        className=\"mt-4 bg-jet text-white font-semibold py-2 px-4 rounded-md hover:bg-neutral-700 focus:outline-none focus:ring-2 focus:ring-blue-300\"\r\n      >\r\n        Save\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AttendanceForm;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}